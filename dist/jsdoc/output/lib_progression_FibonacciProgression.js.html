<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: lib/progression/FibonacciProgression.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: lib/progression/FibonacciProgression.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';
import { Progression } from './Progression';
import * as Utils from '../Utils';
const PROGRESSION_TYPENAME = 'Fibonacci';
/**
 * Defines a series of steps starting from an arbitrary point in the Fibonacci
 * sequence.
 * @extends Progression
 * @example
 * // Fibonacci progression starting at 0*
 * new tngs.FibonacciProgression(0) // 0, 1, 2, 3, 5, ...
 *
 * // Fibonacci progression starting at 5
 * new tngs.FibonacciProgression(5) // 5, 8, 13, 21, 34, ...
 *
 * // *To prevent repeating models, the beginning of the Fibonacci sequence is tweaked.
 */
class FibonacciProgression extends Progression {
    /**
    * Creates an instance of FibonacciProgression.
    * @param {number} _initiator The starting point in the Fibonacci sequence.
    */
    constructor(_initiator) {
        //NOTE: It might seem useful to offer two arbitrary params, e.g. (1.5, 4), and let the user define their own
        //		Fibonacci-ish sequence. I actually tried that, and lo and behold, it basically finds its way back
        //		to the actual Fibonaccis. It doesn't merge, exactly, but it produces the same curve, just slightly
        //		offset.
        //		Makes sense in retrospect. The algorithm only cares about two inputs on the first step. After that,
        //		it exclusively uses one (the sum).
        //		Nature FTW.
        super(true, // always integer based (no need to overcomplicate)
        PROGRESSION_TYPENAME);
        this._initiator = _initiator;
        this._fiboA = 0;
        this._fiboB = 0;
        this._initFiboA = 0;
        this._initFiboB = 0;
        Utils.Assert(this._initiator >= 0);
        if (this._initiator !== Math.floor(this._initiator)) {
            this._initiator = Math.round(this._initiator);
            console.warn('Fibonacci initiator cast to integer: ' + this._initiator);
        }
        // we special case the first few values, to avoid grid iterations that don't differ, e.g. 0, 1, 1, 2, ...
        if (this._initiator &lt;= 1) {
            this._initFiboA = 0;
            this._initFiboB = 1;
        }
        else {
            const FIRST_PICK = FIND_NEAREST_FIBONACCI_NUMBER(this._initiator);
            // choose the two inputs that generate the Fibonacci number nearest the initiator
            this._initFiboA = FIND_NEAREST_FIBONACCI_NUMBER(FIRST_PICK * APPROXIMATE_FIBONACCI_RATIO * APPROXIMATE_FIBONACCI_RATIO);
            this._initFiboB = FIND_NEAREST_FIBONACCI_NUMBER(FIRST_PICK * APPROXIMATE_FIBONACCI_RATIO);
        }
        /* istanbul ignore next */ //[FUTURE PROOFING]
        if (this._initFiboB &lt; this._initFiboA
            || (this._initFiboA === this._initFiboB &amp;&amp; this._initFiboA !== 1)) {
            throw new Error('invalid Fibonacci sequence initiator (' + this._initiator + '). Please choose another value.');
        }
        // this initializes '_fiboA' and '_fiboB'
        this.ResetFibonacciInputs();
    }
    /**
     * Moves to the next value in the series.
     */
    Advance() {
        this._value = this._fiboA + this._fiboB;
        this._fiboA = this._fiboB;
        this._fiboB = this._value;
    }
    Reset() {
        super.Reset();
        this.ResetFibonacciInputs();
    }
    ResetFibonacciInputs() {
        this._fiboA = this._initFiboA;
        this._fiboB = this._initFiboB;
    }
}
//NOTE: Hilarious: https://codegolf.stackexchange.com/questions/133365/find-the-closest-fibonacci-number
//
//		f=(n,x=0,y=1)=>y&lt;n?f(n,y,x+y):y-n>n-x?x:y
//
//		answered Jul 19 '17 at 16:27 by Neil
const FIND_NEAREST_FIBONACCI_NUMBER = (n, x = 0, y = 1) => {
    //PERF: This is not fast! Any high-frequency usage should instead use a cache.
    //NOTE: Although this looks dangerously unbounded, I've tested it up to max-integers, and it only goes ~80 calls deep.
    //		The limits in browsers are all 20k plus, and VSCode 64k; not in the realm of reasonable worry.
    //		...just ensure non-negative!
    Utils.Assert(n >= 0);
    return y &lt; n
        ? FIND_NEAREST_FIBONACCI_NUMBER(n, y, x + y)
        : y - n > n - x
            ? x
            : y;
};
const APPROXIMATE_FIBONACCI_RATIO = 0.6180339850;
Object.freeze(FibonacciProgression);
export { FibonacciProgression };
//# sourceMappingURL=FibonacciProgression.js.map</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-FileIO.html">FileIO</a></li><li><a href="module-main.html">main</a></li><li><a href="module-Utils.html">Utils</a></li></ul><h3>Classes</h3><ul><li><a href="Axis.html">Axis</a></li><li><a href="AxisSet.html">AxisSet</a></li><li><a href="AxisSetTraverser.html">AxisSetTraverser</a></li><li><a href="DataSet.html">DataSet</a></li><li><a href="DataSetFetcher.html">DataSetFetcher</a></li><li><a href="EpochStats.html">EpochStats</a></li><li><a href="ExponentialProgression.html">ExponentialProgression</a></li><li><a href="FailureMessage.html">FailureMessage</a></li><li><a href="FibonacciProgression.html">FibonacciProgression</a></li><li><a href="FileIOResult.html">FileIOResult</a></li><li><a href="Grid.html">Grid</a></li><li><a href="GridOptions.html">GridOptions</a></li><li><a href="GridRunStats.html">GridRunStats</a></li><li><a href="IterationResult.html">IterationResult</a></li><li><a href="LinearProgression.html">LinearProgression</a></li><li><a href="ModelParams.html">ModelParams</a></li><li><a href="ModelStatics.html">ModelStatics</a></li><li><a href="ModelTestStats.html">ModelTestStats</a></li><li><a href="PredictionEvaluation.html">PredictionEvaluation</a></li><li><a href="Progression.html">Progression</a></li><li><a href="SessionData.html">SessionData</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
